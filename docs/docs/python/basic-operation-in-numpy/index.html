<!doctype html><html lang=en dir=ltr>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Getting to know basic opreation in numpy and how to map it with conventional matrix operation in mathematics">
<meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Basic matrix operation in numpy">
<meta property="og:description" content="Getting to know basic opreation in numpy and how to map it with conventional matrix operation in mathematics">
<meta property="og:type" content="article">
<meta property="og:url" content="https://tuidoc.com/docs/python/basic-operation-in-numpy/"><meta property="og:image" content="https://tuidoc.com/docs/python/basic-matrix-operation-in-numpy.png"><meta property="article:section" content="docs">
<title>Basic matrix operation in numpy | Lam Nguyen</title>
<link rel=manifest href=/manifest.json>
<link rel=icon href=/favicon.png type=image/x-icon>
<link rel=stylesheet href=/book.min.b82ae8278f055c5534038f387fbaa30736d6a9ba303969aeb409c8d499ea9085.css integrity="sha256-uCroJ48FXFU0A484f7qjBzbWqbowOWmutAnI1JnqkIU=" crossorigin=anonymous>
<script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.17b237803a30686c7beb53741a354d2a6c693618eca11fc317c7fa0f9990b606.js integrity="sha256-F7I3gDowaGx761N0GjVNKmxpNhjsoR/DF8f6D5mQtgY=" crossorigin=anonymous></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity=sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn crossorigin=anonymous>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js integrity=sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8 crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:!0},{left:'$',right:'$',display:!1},{left:'\\(',right:'\\)',display:!1},{left:'\\[',right:'\\]',display:!0},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\begin{CD}",right:"\\end{CD}",display:!0}],throwOnError:!1})})</script>
</head>
<body dir=ltr>
<input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control>
<main class="container flex">
<aside class=book-menu>
<div class=book-menu-content>
<nav>
<h2 class=book-brand>
<a href=/><span>Lam Nguyen</span>
</a>
</h2>
<div class=book-search>
<input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/>
<div class="book-search-spinner hidden"></div>
<ul id=book-search-results></ul>
</div>
<ul>
<li>
<a href=https://tuidoc.com/docs/introduction/>Introduction</a>
<ul>
</ul>
</li>
<li class=book-section-flat>
<input type=checkbox id=section-426c24f586a1a31f40b6adbe7793c4e5 class=toggle>
<label for=section-426c24f586a1a31f40b6adbe7793c4e5 class="flex justify-between">
<a href=https://tuidoc.com/docs/math/>Math</a>
</label>
<ul>
<li>
<a href=https://tuidoc.com/docs/math/derivative-of-matrix/>Derivative of inverse, eigenvalues and singular values</a>
</li>
</ul>
</li>
<li class=book-section-flat>
<input type=checkbox id=section-dbec22d72f9c0b4ccf9d173e77fe928c class=toggle checked>
<label for=section-dbec22d72f9c0b4ccf9d173e77fe928c class="flex justify-between">
<a href=https://tuidoc.com/docs/python/>Python</a>
</label>
<ul>
<li>
<a href=https://tuidoc.com/docs/python/basic-operation-in-numpy/ class=active>Basic matrix operation in numpy</a>
</li>
</ul>
</li>
<li>
<a href=https://tuidoc.com/docs/contact/>Contact</a>
<ul>
</ul>
</li>
</ul>
</nav>
<script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>
</div>
</aside>
<div class=book-page>
<header class=book-header>
<div class="flex align-center justify-between">
<label for=menu-control>
<img src=/svg/menu.svg class=book-icon alt=Menu>
</label>
<strong>Basic matrix operation in numpy</strong>
<label for=toc-control>
<img src=/svg/toc.svg class=book-icon alt="Table of Contents">
</label>
</div>
<aside class="hidden clearfix">
<nav id=TableOfContents>
<ul>
<li><a href=#introduction>Introduction</a></li>
<li><a href=#how-numpy-array-works>How numpy array works</a></li>
<li><a href=#three-different-matrix-operations-in-numpy>Three different matrix operations in numpy</a>
<ul>
<li><a href=#element-wise-product>Element-wise product</a></li>
<li><a href=#matrix-product-and-matrix-dot-product>Matrix product and matrix dot product</a></li>
</ul>
</li>
<li><a href=#references>References</a></li>
</ul>
</nav>
</aside>
</header>
<article class=markdown><h1 id=basic-matrix-operation-in-numpy>
Basic matrix operation in numpy
<a class=anchor href=#basic-matrix-operation-in-numpy>#</a>
</h1>
<h2 id=introduction>
Introduction
<a class=anchor href=#introduction>#</a>
</h2>
<p><code>numpy</code> is a great tool for performing matrix multiplication. Ever since changing from doing math on handwriting to using <code>python</code>, you often experience troubles finding the differences between matrix operations on numpy, and also how to map it to mathematic formula. This turorial helps to:</p>
<ul>
<li>Guide you over basic on how <code>numpy</code> array works.</li>
<li>Understand three different operation of matrix operation in <code>numpy</code>: <strong>element-wise</strong>,<strong>matrix product</strong>, and <strong>dot product</strong></li>
</ul>
<h2 id=how-numpy-array-works>
How numpy array works
<a class=anchor href=#how-numpy-array-works>#</a>
</h2>
<p>In a general terms, <code>numpy</code> array can be interpreted as multidimensional array which all elements having the same data type. This seems not pretty much different compared to normal <code>python</code> array, but the reason behind is that <code>numpy</code> array is built on the purpose of efficient operation (loop, matrix operation, slicing, &mldr;) which is better than <code>python</code> array in some cases, and <code>numpy</code> also has a great support for <code>linear algebra</code>, <code>statistic</code> operations which is suitable for data science jobs.</p>
<p>Let first compare performace of <code>python</code> and <code>numpy</code> array over a sum of looping 10000 items.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># sum 10000 item using python array</span>
py_array <span style=color:#f92672>=</span> range(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>10000</span>, <span style=color:#ae81ff>1</span>)
<span style=color:#f92672>%</span>timeit <span style=color:#f92672>-</span>n <span style=color:#ae81ff>10000</span> sum(py_array)
</code></pre></div><pre><code>181 µs ± 6.05 µs per loop (mean ± std. dev. of 7 runs, 10000 loops each)
</code></pre>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np

<span style=color:#75715e># sum 10000 items using numpy array</span>
np_array <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>arange(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>10000</span>, <span style=color:#ae81ff>1</span>)
<span style=color:#f92672>%</span>timeit <span style=color:#f92672>-</span>n <span style=color:#ae81ff>10000</span> np<span style=color:#f92672>.</span>sum(np_array)
</code></pre></div><pre><code>7.26 µs ± 364 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
</code></pre>
<p>You can see clearly that <code>numpy</code> array performs better than <code>180/7.28 = 24.725</code> times than <code>python</code> array in this case.</p>
<p>Now, let&rsquo;s also check another case where we should use <code>python</code> array instead:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>%%</span>timeit

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>run_array</span>():
    response <span style=color:#f92672>=</span> []
    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>100000</span>):
        response<span style=color:#f92672>.</span>append(i)
    <span style=color:#66d9ef>return</span> response

run_array()
</code></pre></div><pre><code>8.58 ms ± 477 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</code></pre>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>%%</span>timeit

<span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np

<span style=color:#75715e># perf: numpy array</span>
<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>run_array</span>():
    response <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>empty((<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>), int)
    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>100000</span>):
        response <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>append(response, np<span style=color:#f92672>.</span>array(i))      
    <span style=color:#66d9ef>return</span> response

run_array()
</code></pre></div><pre><code>2 s ± 106 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
</code></pre>
<p>As you can see, the performance over the above trivial case is better in <code>python</code> array. Besides, when using <code>numpy</code> array you will also have to retain a fixed array of data type, while in <code>python</code> array you can store values of multiple data types (<code>int</code>, <code>float</code>, &mldr;). In general:</p>
<ul>
<li>Using <code>numpy</code> array when you can vectorize your computation.</li>
<li>Using <code>python</code> array when you have trivial tasks, check some condition, append some value, &mldr;</li>
</ul>
<h2 id=three-different-matrix-operations-in-numpy>
Three different matrix operations in numpy
<a class=anchor href=#three-different-matrix-operations-in-numpy>#</a>
</h2>
<p><code>numpy</code> supports three different types of matrix operation:</p>
<ul>
<li>Element-wise product, denotes <code>A * B</code></li>
<li>Matrix product, denotes <code>A @ B</code></li>
<li>and matrix dot product, denotes <code>A.dot(B)</code></li>
</ul>
<h3 id=element-wise-product>
Element-wise product
<a class=anchor href=#element-wise-product>#</a>
</h3>
<p>This operation is also called Hadamard product, Schur product, entrywise product, and in mathematics, it&rsquo;s denoted as $ \circ $. This can be understood as <code>same index multiplication</code>, for example:</p>
<p>$$
\begin{bmatrix}
a_{11} & a_{12} & a_{13} & &mldr; & a_{1n} \newline
a_{21} & a_{22} & a_{23} & &mldr; & a_{2n} \newline
a_{n1} & a_{n2} & a_{n3} & &mldr; & a_{nn}
\end{bmatrix}
\circ
\begin{bmatrix}
b_{11} & b_{12} & b_{13} & &mldr; & b_{1n} \newline
b_{21} & b_{22} & b_{23} & &mldr; & b_{2n} \newline
b_{n1} & b_{n2} & b_{n3} & &mldr; & b_{nn}
\end{bmatrix} =
\begin{bmatrix}
a_{11}b_{11} & a_{12}b_{12} & a_{13}b_{13} & &mldr; & a_{1n}b_{1n} \newline
a_{21}b_{21} & a_{22}b_{22} & a_{23}b_{23} & &mldr; & a_{2n}b_{2n} \newline
&mldr; & &mldr; & &mldr; & &mldr; & &mldr; \newline
a_{n1}b_{n1} & a_{n2}b_{n2} & a_{n3}b_{n3} & &mldr; & a_{nn}b_{nn}
\end{bmatrix}
$$</p>
<p>Let do an example in <code>numpy</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np

A <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([
    [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>],
    [<span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>]
])

B <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([
    [<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>],
    [<span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>3</span>]
])

C <span style=color:#f92672>=</span> A <span style=color:#f92672>*</span> B

print(<span style=color:#e6db74>&#34;Example C = A * B&#34;</span>)
print(C)
</code></pre></div><pre><code>Example C = A * B
[[ 3  4  3]
 [20 20 18]]
</code></pre>
<h3 id=matrix-product-and-matrix-dot-product>
Matrix product and matrix dot product
<a class=anchor href=#matrix-product-and-matrix-dot-product>#</a>
</h3>
<p>My experience with <code>numpy</code> was really confusing on how to map normal matrix multiplication which i use in my handwritting to an appropriate opration in <code>numpy</code>. Basically there are two options for it: matrix product <code>@</code> and matrix dot product (<code>.dot</code>). The operation of those two is different as follows:</p>
<ul>
<li>In two dimensional array, both <code>@</code> and <code>.dot</code> perform the same operation which is normal matrix multiplication.</li>
<li>In higher dimensional array ($ n >= 3 $), they perform slightly different:
<ul>
<li>For <code>@</code>, it is treated as a stack of matrices residing in the last two indices and broadcast accordingly.</li>
<li>For <code>.dot</code>, it is a sum product over the last axis of a and the second-to-last of b.</li>
</ul>
</li>
</ul>
<p>Let first take an example of 2 dimensional array to see they generate the same result as matrix multiplication</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np

A <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([
    [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>],
    [<span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>]
])

B <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([
    [<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>2</span>],
    [<span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>4</span>],
    [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>]
])

print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Example: @ operation of </span><span style=color:#e6db74>{</span>A<span style=color:#f92672>.</span>shape<span style=color:#e6db74>}</span><span style=color:#e6db74> x </span><span style=color:#e6db74>{</span>B<span style=color:#f92672>.</span>shape<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
C <span style=color:#f92672>=</span> A <span style=color:#f92672>@</span> B
print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;A @ B equal </span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>{</span>C<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)

print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;.dot operation of </span><span style=color:#e6db74>{</span>A<span style=color:#f92672>.</span>shape<span style=color:#e6db74>}</span><span style=color:#e6db74> and </span><span style=color:#e6db74>{</span>B<span style=color:#f92672>.</span>shape<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
D <span style=color:#f92672>=</span> A<span style=color:#f92672>.</span>dot(B)
print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;A.dot(B) equal </span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>{</span>D<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</code></pre></div><pre><code>Example: @ operation of (2, 3) x (3, 2)
A @ B equal 
[[16 19]
 [43 46]]
Example: .dot operation of (2, 3) and (3, 2)
A.dot(B) equal 
[[16 19]
 [43 46]]
</code></pre>
<p>The result is the same of the below two matrix multiplications:</p>
<p>$$
\begin{bmatrix}
1 & 2 & 3 \newline
4 & 5 & 6
\end{bmatrix}
\begin{bmatrix}
3 & 2 \newline
5 & 4 \newline
1 & 3
\end{bmatrix} =
\begin{bmatrix}
1x3 + 2x5 + 3x1 & 1x2 + 2x4 + 3x3 \newline
4x3 + 5x5 + 6x1 & 4x2 + 5x4 + 6x3
\end{bmatrix} =
\begin{bmatrix}
16 & 19 \newline
43 & 46
\end{bmatrix}
$$</p>
<p>And, Let take an example in 3 dimensonal array shape <code>(2, 2, 3)</code> and <code>(2, 3, 2)</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np

A <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([
    [
        [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>],
        [<span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>]
    ],
    [
        [<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>1</span>],
        [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>4</span>]
    ]
])

B <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([
    [
        [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>],
        [<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>],
        [<span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>]
    ],
    [
        [<span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>],
        [<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>],
        [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>]
    ]
])
print(<span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>50</span>)
print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Shape of matrix A = </span><span style=color:#e6db74>{</span>A<span style=color:#f92672>.</span>shape<span style=color:#e6db74>}</span><span style=color:#e6db74> and B = </span><span style=color:#e6db74>{</span>B<span style=color:#f92672>.</span>shape<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
print(<span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>50</span>)

C <span style=color:#f92672>=</span> A <span style=color:#f92672>@</span> B
print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Result of A @ B equal </span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>{</span>C<span style=color:#e6db74>}</span><span style=color:#e6db74> with shape </span><span style=color:#e6db74>{</span>C<span style=color:#f92672>.</span>shape<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
print(<span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>50</span>)

D <span style=color:#f92672>=</span> A<span style=color:#f92672>.</span>dot(B)
print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Result of A.dot(B) equal </span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>{</span>D<span style=color:#e6db74>}</span><span style=color:#e6db74> with shape </span><span style=color:#e6db74>{</span>D<span style=color:#f92672>.</span>shape<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
print(<span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>50</span>)
</code></pre></div><pre><code>--------------------------------------------------
Shape of matrix A = (2, 2, 3) and B = (2, 3, 2)
--------------------------------------------------
Result of A @ B equal 
[[[22 28]
  [49 64]]

 [[25 32]
  [15 22]]] with shape (2, 2, 2)
--------------------------------------------------
Result of A.dot(B) equal 
[[[[22 28]
   [14 20]]

  [[49 64]
   [41 56]]]


 [[[17 24]
   [25 32]]

  [[27 34]
   [15 22]]]] with shape (2, 2, 2, 2)
--------------------------------------------------
</code></pre>
<p>You can see that they&rsquo;re generating different results. Turns out:</p>
<p>In <code>@</code> case, it&rsquo;s comprised of two matrix operation:</p>
<p>$$
\begin{bmatrix}
1 & 2 & 3 \newline
4 & 5 & 6
\end{bmatrix}
\begin{bmatrix}
1 & 2 \newline
3 & 4 \newline
5 & 6
\end{bmatrix} =
\begin{bmatrix}
22 & 28 \newline
49 & 64
\end{bmatrix}
$$</p>
<p>and</p>
<p>$$
\begin{bmatrix}
3 & 3 & 1 \newline
1 & 2 & 4
\end{bmatrix}
\begin{bmatrix}
5 & 6 \newline
3 & 4 \newline
1 & 2
\end{bmatrix} =
\begin{bmatrix}
25 & 32 \newline
15 & 22
\end{bmatrix}
$$</p>
<p>In <code>.dot</code> case, the operation acts like nested looping over dimensions that are greater than <code>2</code> and performs vector product from each associated row and column for last second dimensions. The below is a simulation on how this operation would work in 3 dimensional array.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>matrix_result <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>empty([<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>])
<span style=color:#66d9ef>for</span> matrix_A_id, matrix_A <span style=color:#f92672>in</span> enumerate(A):
    <span style=color:#66d9ef>for</span> row_A_id, row_A <span style=color:#f92672>in</span> enumerate(matrix_A):
        <span style=color:#66d9ef>for</span> matrix_B_id, matrix_B <span style=color:#f92672>in</span> enumerate(B):
             <span style=color:#66d9ef>for</span> col_B_id, col_B <span style=color:#f92672>in</span> enumerate(matrix_B<span style=color:#f92672>.</span>T):
                    matrix_result[matrix_A_id, matrix_B_id, row_A_id, col_B_id ] <span style=color:#f92672>=</span> row_A <span style=color:#f92672>*</span> col_B
</code></pre></div><h2 id=references>
References
<a class=anchor href=#references>#</a>
</h2>
<ul>
<li><a href=https://numpy.org/devdocs/user/quickstart.html#basic-operations>Numpy quickstart</a></li>
<li><a href=https://webcourses.ucf.edu/courses/1249560/pages/python-lists-vs-numpy-arrays-what-is-the-difference>Python Lists vs. Numpy Arrays - What is the difference?</a></li>
</ul>
</article>
<footer class=book-footer>
<div class="flex flex-wrap justify-between">
</div>
<script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>
</footer>
<div class=book-comments>
</div>
<label for=menu-control class="hidden book-menu-overlay"></label>
</div>
<aside class=book-toc>
<div class=book-toc-content>
<nav id=TableOfContents>
<ul>
<li><a href=#introduction>Introduction</a></li>
<li><a href=#how-numpy-array-works>How numpy array works</a></li>
<li><a href=#three-different-matrix-operations-in-numpy>Three different matrix operations in numpy</a>
<ul>
<li><a href=#element-wise-product>Element-wise product</a></li>
<li><a href=#matrix-product-and-matrix-dot-product>Matrix product and matrix dot product</a></li>
</ul>
</li>
<li><a href=#references>References</a></li>
</ul>
</nav>
</div>
</aside>
</main>
</body>
</html>